<!DOCTYPE html>
<html>
    <head>
        <title>Autonomicpilot - zf2 Tag Page - zf2, zendframework2, Zend\Form, Zend\Form\Annotation, ComposedObject, zf2, zendframework2, Zend\Form, Service Locator, Service Manager, Dependency Injection, invokables, factories, php, zf2, zendframework2, Service Locator, Service Manager, Dependency Injection, invokables, factories, php, zf2, zendframework2, Service Locator, Service Manager, Dependency Injection, invokables, factories, php, zf2, zendframework2, invokables, factories, php, zf2, zendframework2, zf2, composer, translation</title>
        <meta name="description" content="Autonomicpilot is a development blog mainly concerntrating on PHP, MySQL, HTML, dojo js and Zend Framework. zf2, zendframework2, Zend\Form, Zend\Form\Annotation, ComposedObject, zf2, zendframework2, Zend\Form, Service Locator, Service Manager, Dependency Injection, invokables, factories, php, zf2, zendframework2, Service Locator, Service Manager, Dependency Injection, invokables, factories, php, zf2, zendframework2, Service Locator, Service Manager, Dependency Injection, invokables, factories, php, zf2, zendframework2, invokables, factories, php, zf2, zendframework2, zf2, composer, translation"></meta>
        <meta name="keywords" content="Autonomicpilot is a development blog mainly concerntrating on PHP, MySQL, HTML, dojo js and Zend Framework. zf2, zendframework2, Zend\Form, Zend\Form\Annotation, ComposedObject, zf2, zendframework2, Zend\Form, Service Locator, Service Manager, Dependency Injection, invokables, factories, php, zf2, zendframework2, Service Locator, Service Manager, Dependency Injection, invokables, factories, php, zf2, zendframework2, Service Locator, Service Manager, Dependency Injection, invokables, factories, php, zf2, zendframework2, invokables, factories, php, zf2, zendframework2, zf2, composer, translation"></meta>
        <link rel="stylesheet" type="text/css" href="/css/reset.css" />
        <link rel="stylesheet" type="text/css" href="/css/site.css" />
        <script type="text/javascript">
            var dsloaded = false;
            var disqus_div = 'disqus_thread';
            function showthatshizzle() {
                var disqus_shortname = 'autonomicpilot';

                if ( dsloaded )
                {
                    return;
                }

                dsloaded = true;

                document.getElementById(disqus_div).style.display = 'block';

                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            }
        </script>
        <script type="text/javascript">

            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-16183577-1']);
            _gaq.push(['_trackPageview']);

        </script>
    </head>
    <body>
        <div id="main_box">
            <div id="header">
                <a href='/'>&nbsp;</a>
                <div>The 8-bit ramblings of a rabid mind</div>
                <br class="clear_both" />
            </div>
            <div id="top_nav">
                <div class="box0n float_left third_width"><a href="/">Home</a></div>
                <div class="box0n float_left third_width"><a href="/blog/">Blog</a></div>
                <div class="box0n float_left third_width"><a href="/cv.html">CV</a></div>
                <br class="clear_both" />
            </div>
            <div id="content_outer">
                <div id="left" class="float_left">
                    <div class="article_link box0n">
                        <br />
                        <a href="/blog/#ZF2ComposedObjects">ZF2 Forms, Annotations and Composed Objects</a>
                        <table><tbody>
                        <tr><td class='enbolden'>Static:</td><td><a class="article_link_main" href='/blog/Posts/ZF2ComposedObjects.html'>link</a></td></tr>
                        <tr><td class='enbolden'>Published:</td><td>14/04/13 13:00:18</td></tr>
                        <tr><td class='enbolden'>Category:</td><td>        <a href="/blog/Categories/ZF2.html">ZF2</a><br /></td></tr>
                        <tr><td class='enbolden'>Tags:</td><td><div class="article_tags">
                                <a href="/blog/Tags/zf2.html">zf2</a>        <a href="/blog/Tags/zendframework2.html">zendframework2</a>        <a href="/blog/Tags/Zend\Form.html">Zend\Form</a>        <a href="/blog/Tags/Zend\Form\Annotation.html">Zend\Form\Annotation</a>        <a href="/blog/Tags/ComposedObject.html">ComposedObject</a>
                        </div></td></tr>
                        </tbody></table>
                    </div>                    <div class="article_link box0n">
                        <br />
                        <a href="/blog/#Zf2CustomFormElement">ZF2 Custom Form Element</a>
                        <table><tbody>
                        <tr><td class='enbolden'>Static:</td><td><a class="article_link_main" href='/blog/Posts/Zf2CustomFormElement.html'>link</a></td></tr>
                        <tr><td class='enbolden'>Published:</td><td>29/03/13 08:19:03</td></tr>
                        <tr><td class='enbolden'>Category:</td><td>        <a href="/blog/Categories/ZF2.html">ZF2</a><br /></td></tr>
                        <tr><td class='enbolden'>Tags:</td><td><div class="article_tags">
                                <a href="/blog/Tags/zf2.html">zf2</a>        <a href="/blog/Tags/zendframework2.html">zendframework2</a>        <a href="/blog/Tags/Zend\Form.html">Zend\Form</a>
                        </div></td></tr>
                        </tbody></table>
                    </div>                    <div class="article_link box0n">
                        <br />
                        <a href="/blog/#SMVsDIAndIoC">Dependency Injection Tag Page</a>
                        <table><tbody>
                        <tr><td class='enbolden'>Static:</td><td><a class="article_link_main" href='/blog/Posts/SMVsDIAndIoC.html'>link</a></td></tr>
                        <tr><td class='enbolden'>Published:</td><td>14/10/12 12:55:46</td></tr>
                        <tr><td class='enbolden'>Category:</td><td>        <a href="/blog/Categories/IoC.html">IoC</a><br /></td></tr>
                        <tr><td class='enbolden'>Tags:</td><td><div class="article_tags">
                                <a href="/blog/Tags/Service Locator.html">Service Locator</a>        <a href="/blog/Tags/Service Manager.html">Service Manager</a>        <a href="/blog/Tags/Dependency Injection.html">Dependency Injection</a>        <a href="/blog/Tags/invokables.html">invokables</a>        <a href="/blog/Tags/factories.html">factories</a>        <a href="/blog/Tags/php.html">php</a>        <a href="/blog/Tags/zf2.html">zf2</a>        <a href="/blog/Tags/zendframework2.html">zendframework2</a>
                        </div></td></tr>
                        </tbody></table>
                    </div>                    <div class="article_link box0n">
                        <br />
                        <a href="/blog/#FactoriesVsInvokables">factories Tag Page</a>
                        <table><tbody>
                        <tr><td class='enbolden'>Static:</td><td><a class="article_link_main" href='/blog/Posts/FactoriesVsInvokables.html'>link</a></td></tr>
                        <tr><td class='enbolden'>Published:</td><td>11/10/12 14:55:54</td></tr>
                        <tr><td class='enbolden'>Category:</td><td>        <a href="/blog/Categories/Uncategorised.html">Uncategorised</a><br /></td></tr>
                        <tr><td class='enbolden'>Tags:</td><td><div class="article_tags">
                                <a href="/blog/Tags/Service Locator.html">Service Locator</a>        <a href="/blog/Tags/Service Manager.html">Service Manager</a>        <a href="/blog/Tags/Dependency Injection.html">Dependency Injection</a>        <a href="/blog/Tags/invokables.html">invokables</a>        <a href="/blog/Tags/factories.html">factories</a>        <a href="/blog/Tags/php.html">php</a>        <a href="/blog/Tags/zf2.html">zf2</a>        <a href="/blog/Tags/zendframework2.html">zendframework2</a>        <a href="/blog/Tags/Service Locator.html">Service Locator</a>        <a href="/blog/Tags/Service Manager.html">Service Manager</a>        <a href="/blog/Tags/Dependency Injection.html">Dependency Injection</a>        <a href="/blog/Tags/invokables.html">invokables</a>        <a href="/blog/Tags/factories.html">factories</a>        <a href="/blog/Tags/php.html">php</a>        <a href="/blog/Tags/zf2.html">zf2</a>        <a href="/blog/Tags/zendframework2.html">zendframework2</a>        <a href="/blog/Tags/invokables.html">invokables</a>        <a href="/blog/Tags/factories.html">factories</a>        <a href="/blog/Tags/php.html">php</a>        <a href="/blog/Tags/zf2.html">zf2</a>        <a href="/blog/Tags/zendframework2.html">zendframework2</a>
                        </div></td></tr>
                        </tbody></table>
                    </div>                    <div class="article_link box0n">
                        <br />
                        <a href="/blog/#ZSAAndG403Translator">Zend Skeleton App And G403Translator</a>
                        <table><tbody>
                        <tr><td class='enbolden'>Static:</td><td><a class="article_link_main" href='/blog/Posts/ZSAAndG403Translator.html'>link</a></td></tr>
                        <tr><td class='enbolden'>Published:</td><td>27/08/12 15:37:10</td></tr>
                        <tr><td class='enbolden'>Category:</td><td>        <a href="/blog/Categories/ZF2.html">ZF2</a><br /></td></tr>
                        <tr><td class='enbolden'>Tags:</td><td><div class="article_tags">
                                <a href="/blog/Tags/zf2.html">zf2</a>        <a href="/blog/Tags/composer.html">composer</a>        <a href="/blog/Tags/translation.html">translation</a>
                        </div></td></tr>
                        </tbody></table>
                    </div>                    <div class="article_link box0n">
                        <br />
                        <a href="/blog/#ZSAAndZFCUser">Blog</a>
                        <table><tbody>
                        <tr><td class='enbolden'>Static:</td><td><a class="article_link_main" href='/blog/Posts/ZSAAndZFCUser.html'>link</a></td></tr>
                        <tr><td class='enbolden'>Published:</td><td>15/07/12 15:58:14</td></tr>
                        <tr><td class='enbolden'>Category:</td><td>        <a href="/blog/Categories/ZF2.html">ZF2</a><br /></td></tr>
                        <tr><td class='enbolden'>Tags:</td><td><div class="article_tags">
                        
                        </div></td></tr>
                        </tbody></table>
                    </div>
                </div>
                <div id="main" class="float_left">
                    <div>
                    <div class="article_content box0n" id="ZF2ComposedObjects">
                        <h1 class="article_title"><a href="/blog/Posts/ZF2ComposedObjects.html">ZF2 Forms, Annotations and Composed Objects</a></h1>
                        <h1>ZF2 Annotated Forms and ComposedObject</h1>

<p>So you're using the data mapper pattern, just for awesomeness. You're also using annotated entities being parsed into forms, since in most cases your entities are in a one to one relationship with your forms.</p>

<p>However you do occasionally need forms that are made up of multiple entities.</p>

<p>you could create a new entity with all the bits in and then parse them into seperate entities for persisting.</p>

<p>However it's easier to create a new entity using multiple @Annotation/ComposedObject annotations, this gives us unified validation and can get the seperate entities easily from the outer entity.</p>

<p>Here we have the factory for creating the form.<br />
Form Factory:</p>

<pre class="language-php prettyprint linenums"><code>'WelcomeMessageForm' =&gt; function ($sm) {

    $msg = new Model\WelcomeMessage;

    $fc =  new Model\LicenceContent;
    $msg-&gt;setFutureMessage($fc);

    $cc =  new Model\LicenceContent;
    $msg-&gt;setCurrentMessage($cc);

    $builder = new \Zend\Form\Annotation\AnnotationBuilder;
    $form = $builder-&gt;createForm($msg);
    $form-&gt;bind($msg);

    $form-&gt;get('current_message')-&gt;setObject(new Model\LicenceContent);
    $form-&gt;get('future_message')-&gt;setObject(new Model\LicenceContent);
    return $form;
},
</code></pre>

<p>When using ComposedObject, the composed objects are parsed into fieldsets within the form.<br />
By doing the setObject calls on the fieldsets in the factory, this allows the form to iterate through the composed objects in a 'populated' main entity to populate values in the form.</p>

<p>WelcomeMessage Entity:</p>

<pre class="language-php prettyprint linenums"><code>namespace Module\Model;
use Zend\Form\Annotation;
/**
 * @Annotation\Hydrator("Zend\Stdlib\Hydrator\ClassMethods")
 */
class WelcomeMessage
{

    /**
     * @Annotation\Hydrator("Zend\Stdlib\Hydrator\ClassMethods")
     * @Annotation\ComposedObject("Module\Model\LicenceContent")
     */
    protected $current_message;

    /**
     * @Annotation\Hydrator("Zend\Stdlib\Hydrator\ClassMethods")
     * @Annotation\ComposedObject("Module\Model\LicenceContent")
     */
    protected $future_message;

    public function getCurrentMessage()
    {
        return $this-&gt;current_message;
    }

    public function setCurrentMessage($currentMessage)
    {
        $this-&gt;current_message = $currentMessage;
        return $this;
    }

    public function getFutureMessage()
    {
        return $this-&gt;future_message;
    }

    public function setFutureMessage($futureMessage)
    {
        $this-&gt;future_message = $futureMessage;
        return $this;
    }

}
</code></pre>

<p>Here we have a simple 'super' entity composed of 2 other objects (in this example, both the same type).</p>

<p>Controller Action:</p>

<pre class="language-php prettyprint linenums"><code>public function welcomeAction()
{
    //get id from session
    $licence_id = $this-&gt;zfcUserAuthentication()-&gt;getIdentity()-&gt;getId();
    $viewModel = new ViewModel();
    $form      = $this-&gt;getCustomiseService()-&gt;getWelcomeMessageForm();
    if ($this-&gt;getRequest()-&gt;isPost()) {
        $data = $this-&gt;params()-&gt;fromPost();
        $form-&gt;setData($data);
        if ($form-&gt;isValid()) {
            /* @var $entity \Module\Model\WelcomeMessage */
            $entity = $form-&gt;getData();

            /* @var $curMsg \Module\Model\LicenceContent */
            $curMsg = $entity-&gt;getCurrentMessage();

            /* @var $ftrMsg \Module\Model\LicenceContent */
            $ftrMsg = $entity-&gt;getFutureMessage();

            $this-&gt;getCustomiseService()-&gt;updateWelcomeMessage($licence_id, $curMsg, $ftrMsg);

        }
    }
    $form-&gt;setHydrator(new \Zend\Stdlib\Hydrator\ClassMethods);
    $entity = $this-&gt;getCustomiseService()-&gt;getWelcomeMessage($licence_id);
    $form-&gt;bind($entity);
    $viewModel-&gt;setVariable('form', $form);
    return $viewModel;
}
</code></pre>

<p>Here we have a simple action for validating and saving a form, and for also fetching a 'populated' entity from the db.</p>

<p>And that's it, we have a main object made out of 2 composed objects, the 2 composed objects are parsed into fieldsets in the main form. You can retrieve and set/populate the values of the composed objects easily.</p>

                    </div>                    <div class="article_content box0n" id="Zf2CustomFormElement">
                        <h1 class="article_title"><a href="/blog/Posts/Zf2CustomFormElement.html">ZF2 Custom Form Element</a></h1>
                        <h1>ZF2 Custom Form Element</h1>

<p>I recently needed a way to output plain text as part of a form, that would take a value just like a normal form element would.<br />
It's very similar to something I needed to do in ZF1 and it always weirds me that ZF doesn't include something like this by default.</p>

<p>We need 4 files to add our new element:</p>

<ul>
<li>The form element</li>
<li>The view helper for the element</li>
<li>An override of the generic FormElement view helper</li>
<li>A Module.php to add our element to the view helper config</li>
</ul>

<p>I've been putting things that tend to be site wide in the application module, or seperate them into another module to be added at the vendor level.</p>

<p>This is our form element, we don't do anything fancy, it's just declaring the type.</p>

<pre><code>namespace Application\Form\Element;

use Zend\Form\Element;

class PlainText extends Element
{
    protected $attributes = array(
        'type' =&gt; 'plaintext',
    );
}
</code></pre>

<p>This is our view helper, very basic, just returns the value rather than parsing it into some fancy html</p>

<pre><code>namespace Application\Form\View\Helper;

use Zend\Form\View\Helper\AbstractHelper;
use Zend\Form\ElementInterface;

class FormPlainText extends AbstractHelper {

    public function render(ElementInterface $element) {
        return $element-&gt;getValue();
    }

    public function __invoke(ElementInterface $element = null) {
        return $this-&gt;render($element);
    }

}
</code></pre>

<p>Here we override the generic FormElement helper so that generic rendering methods, such as $this->formRow will work with our new element.</p>

<pre><code>namespace Application\Form\View\Helper;

use Application\Form\Element;
use Zend\Form\View\Helper\FormElement as BaseFormElement;
use Zend\Form\ElementInterface;

class FormElement extends BaseFormElement
{
    public function render(ElementInterface $element)
    {
        $renderer = $this-&gt;getView();
        if (!method_exists($renderer, 'plugin')) {
            // Bail early if renderer is not pluggable
            return '';
        }

        if ($element instanceof Element\PlainText) {
            $helper = $renderer-&gt;plugin('form_plain_text');
            return $helper($element);
        }

        return parent::render($element);
    }
}
</code></pre>

<p>And finally we add our bits to the module configuration</p>

<pre><code>namespace Application;

use Zend\Mvc\ModuleRouteListener;
use Zend\Mvc\MvcEvent;

class Module
{

    public function getViewHelperConfig()
    {
        return array(
            'invokables' =&gt; array(
                'formelement'       =&gt; 'Application\Form\View\Helper\FormElement',
                'formPlainText'     =&gt; 'Application\Form\View\Helper\FormPlainText',
            ),
        );
    }
</code></pre>

<p>Now when we declare our forms we can add a plaintext form element</p>

<pre><code><br />                    $form-&gt;add(array(
                        'type' =&gt; 'Application\Form\Element\PlainText',
                        'name' =&gt; 'start_date',
                        'attributes' =&gt; array(
                            'id' =&gt; 'TrialStart',
                        ),
                        'options' =&gt; array(
                            'label' =&gt; 'Trial Start Date',
                        ),
                    ));
</code></pre>

<p>And jobs done, you could add a second element which also renders a hidden field along with the plain text if you need the value being submitted too.</p>

                    </div>                    <div class="article_content box0n" id="SMVsDIAndIoC">
                        <h1 class="article_title"><a href="/blog/Posts/SMVsDIAndIoC.html">Dependency Injection Tag Page</a></h1>
                        <p>Quick notes for dependency injection vs service locator, this is mainly for zf2 but the basics apply elsewhere.</p>

<h2 id="smvdiioc-ioc">Inversion of Control</h2>

<p>IoC is a way of getting modules or objects into the right class when they're needed, the instantiation of an object is abstracted away from the class requiring it, in a way that makes duck typing a practical reality.</p>

<h2 id="smvdiioc-di">Dependency Injection</h2>

<p>DI is, in it's most basic form, the process of inserting dependencies(obj b and c) into the object requiring them(obj a) without that object(obj a) needing to know how it happened.</p>

<pre><code>$a = new A(new B);  //constructor injection
$a-&gt;setC(new C);    //setter injection

class A
{
    public __contructor(B $b) {
        $this-&gt;b = $b;
    }

    public setC(C $c) {
        $this-&gt;c = $c;
    }
}

</code></pre>

<p>In ZF2, the dependency injection is implemented as a depenedency injection container, Zend/Di, it relies on reflection to ascertain what objects are required for the construction of a particular object. Configuration is set up so that when Zend/Di is required to construct a certain object, it knows that it either needs to pass instances of certain other objects to the constructor or to call a 'set' function for that dependency. e.g. obj a requires obj b and obj c, the __construct function signature calls for an object of type b and there is a setC function whos signature calls for an object of type C.
Objects B and C may require further dependencies that can be configured to be injected as well.</p>

<p>This can be considered as an implicit way of injecting dependencies.</p>

<h2 id="smvdiioc-sl">Service Locator</h2>

<p>SL is in essence a way for the object(obj a) to get it's own dependencies without having to rely on an external source to set them for it. Rather than instantiating them itself an SL is injected into the object(obj a) and that is used to fetch the dependencies.</p>

<h4 id="smvdiioc-sl">Classic Service Loctor</h4>

<pre><code>class A
{
    public __construct(ServiceLocator $sl) {
        $this-&gt;sl = $sl;
    }

    public getC() {
        if ( !is_set($this-&gt;c) ) {
            $this-&gt;c = $this-&gt;sl-&gt;get('c');
        }
        return $this-&gt;c;
    }
    public getB() {
        if ( !is_set($this-&gt;b) ) {
            $this-&gt;b = $this-&gt;sl-&gt;get('b');
        }
        return $this-&gt;b;
    }
}

</code></pre>

<p>In ZF2, we use the Zend/ServiceManager(SM) as an implementation of the service locator pattern, in the SM we set a key to be an instance of an object, if the object being constructed itself has no dependencies that's the end, however if it does have dependencies then we use a factory or an invokable to pass the sm to an inteligent object that then gets further dependencies from the SM. e.g. obj a relies on obj b and obj c, we pass a factory to the SM as the way of instantiating a, in this factory the sl is passed into it and the factory uses the sl to retrieve instances of obj b and obj c which are used to construct obj a and the new instance of obj a is returned.</p>

<h4 id="smvdiioc-slinvoke">SM Invokable</h4>

<pre><code>class A
{
    public function __invoke(ServiceManager $sm) {
        $b = $sm-&gt;get('b');
        $c = $sm-&gt;get('c');
        $a = new A($b);
        $a-&gt;setC($c);
        return $a;
    }
}
</code></pre>

<p>This can be considered an explicit way of injecting dependencies.</p>

<h1>DI vs SL</h1>

<p>Di is a bit easier to set up, as it just requires a lot of writing configs, it's also less magical as all the deps for a class are in front of your face in the config files, however Zend\Di is a lot more magical than the classical version of it, as it does require a lot of reflection (which may be cacheable) to work out how to get the dep into the class, this can be costly on resources in large classes.</p>

<p>On the other hand Zend/ServiceManager uses individual closures or factories to retrieve the deps for instantiating the service requested, and these deps could need further factories for further deps etc requiring a further coder to piece through more and more classes(factories or closures) to understand all the deps being used but you get the service when you need, if in some circumstances you don't need the dep you don't ask for it and you save some resources, with DI you will always have all deps in place, whether you use them or not.</p>

<p>Also as DI is configured as deps for a class, if multiple places require the same dep you'd have to configure each, whereas with SL you'd just ask for it and it'd already be available without extra configuration.</p>

                    </div>                    <div class="article_content box0n" id="FactoriesVsInvokables">
                        <h1 class="article_title"><a href="/blog/Posts/FactoriesVsInvokables.html">factories Tag Page</a></h1>
                        <p>These are just some quick notes really, just for some future reference, mostly concerned with the differences as they pertain to invokables and factories in Zend/ServiceManager.</p>

<h2>Invokables</h2>

<p>An invokable is simply a class that can be instantiated, it doesn't normally require any deps and can just be instantiated when needed, like controllers normally have no dependencies that are required during construction nor any deps required after construction and before the object can start work, even if they're set via setters.</p>

<h2>Factories</h2>

<p>If your dependency is dependent on other objects that need fetching before the object will work properly, even if these are set via setters rather than during construction and inteligent object, in this case a factory, is the way to go. A factory can be a closure straight in the config (but this stops caching), in the module.php or as concrete classes. These classes are either invokable via __invoke or implement the FactoryInterface.</p>

<h4>Closure:</h4>

<pre><code>    'service_manager' =&gt; array(
        'factories' =&gt; array(
            'something' =&gt; function ($sm) {
                $se = $sm-&gt;get('somethingelse');
                $s = new Something($se);
                return $s;
            },
        ),
    ),
</code></pre>

<h4>Factory object</h4>

<pre><code>    'service_manager' =&gt; array(
        'factories' =&gt; array(
            'something' =&gt; 'SomethingFactory',
        ),
    ),

class SomethingFactory implements FactoryInterface
{
    public function createService(ServiceLocatorInterface $sm)
    {
        $se = $sm-&gt;get('somethingelse');
        $s = new Something($se);
        return $s;
    }
}
</code></pre>

<h4>Invokable factory</h4>

<pre><code>    'service_manager' =&gt; array(
        'invokables' =&gt; array(
            'something' =&gt; 'SomethingFactoryInvokable',
        ),
    ),


class Something
{
    public function __invoke(ServiceLocatorInterface $sm)
    {
        $se = $sm-&gt;get('somethingelse');
        $s = new Something($se);
        return $s;
    }
}
</code></pre>

<p>The concrete class way is best when you're doing some fairly substantial work.
You can either implement the FactoryInterface and then the createService method (which takes a servicelocatorinterface object) or just make the class invokable by implementing __invoke (which also takes the sm in). You can then retrieve other objects from the servicemanager (invokables or factories) and then return an instance of some object, of a singluar type per factory, as a result.</p>

<p>And that's it!</p>

                    </div>                    <div class="article_content box0n" id="ZSAAndG403Translator">
                        <h1 class="article_title"><a href="/blog/Posts/ZSAAndG403Translator.html">Zend Skeleton App And G403Translator</a></h1>
                        <h1>ZSA And Db Driven Translation</h1>

<p>I recently had need to do some translations with ZF2, the current state of ZF2 means that you can only load translations from files so I decided to take this oppertunity to experiment with creating my own module for doing it.</p>

<p><a href="http://www.dasprids.de/blog/2012/08/23/feeding-zend-i18n-translator-from-a-database">DASPRiD</a> had already had a bash at creating something for this but unfortunately it didn't work, I was able to take the code and work with it to produce this module.</p>

<p>There's a generic <a href="https://github.com/zendframework/ZendSkeletonModule">Zend Skeleton Module</a> which I cloned locally and created my own <a href="https://github.com/gabriel403/G403Translator">GitHub repo</a> for storing the final product. It's also published in <a href="http://packagist.org/packages/gabriel403/g403-translator">Packagist</a> so it's dead easy to install.</p>

<p>So first we fork or clone the ZendSkeleton Application and then checkout a new branch to work on<br />
<img src="http://blackdwarf.autonomicpilot.co.uk/caps/ad4c7e.png" alt="" /><br />
we edited the composer.json to get the latest version of ZF2 and also to fetch our G403Translation module<br />
<img src="http://blackdwarf.autonomicpilot.co.uk/caps/cb8da4.png" alt="composer.json file" /></p>

<p>Then we get composer to install our modules for us 
<img src="http://blackdwarf.autonomicpilot.co.uk/caps/973717.png" alt="composer install command" /></p>

<p>After that we set up our db and user and imported our SQL that's in the README.md for the module <img src="http://blackdwarf.autonomicpilot.co.uk/caps/31434f.png" alt="sql" /> Here we're using custom table names, the default assumed within the module are zend_locale and zend_translate_message.</p>

<p>Then we set up the db connection within the code itself 
<img src="http://blackdwarf.autonomicpilot.co.uk/caps/811988.png" alt="db connection config file" /><br />
this file is within config/autoload/ and also another file for setting up the translator, as with all configs this can be done in a module config or in the config/autoload/ directory in this example inside the autload config 
<img src="http://blackdwarf.autonomicpilot.co.uk/caps/d4a006.png" alt="translator config file" /></p>

<p>We then insert some data into the tables</p>

<p><img src="http://blackdwarf.autonomicpilot.co.uk/caps/d24bcf.png" alt="locale table" />
<img src="http://blackdwarf.autonomicpilot.co.uk/caps/0804cf.png" alt="messages table" /></p>

<p>And we can see the change in our Zend Skeleton Application from
<img src="http://blackdwarf.autonomicpilot.co.uk/caps/c12fb6.png" alt="Original ZSA" /> 
to
<img src="http://blackdwarf.autonomicpilot.co.uk/caps/fb2cdb.png" alt="New ZSA" /></p>

<p>Tah dah!</p>

<p>To learn a bit about plurals read <a href="http://translate.sourceforge.net/wiki/l10n/pluralforms">here.</a></p>

                    </div>                    <div class="article_content box0n" id="ZSAAndZFCUser">
                        <h1 class="article_title"><a href="/blog/Posts/ZSAAndZFCUser.html">Blog</a></h1>
                        <p>So I've been playing a lot with <a href="https://github.com/zendframework/zf2/">zf2</a> recently and inspired by <a href="http://blog.evan.pro/getting-started-with-the-zf2-skeleton-and-zfcuser">EvanDotPro's post</a> on getting things working using pure git I thought I'd throw one up using composer+git.</p>

<p>So after forking the <a href="https://github.com/zendframework/ZendSkeletonApplication">Zend Skeleton Application</a> I got one with working with it locally, I cloned the remote repo and checked out a new branch for playing with <img src="http://blackdwarf.autonomicpilot.co.uk/caps/e73ec8.png" alt="zsa cloning" /></p>

<p>I then edited the composer.json file to fetch <a href="https://github.com/ZF-Commons/ZfcUser">ZfcUser</a> which in turn fetches <a href="https://github.com/ZF-Commons/ZfcBase">ZfcBase</a> like this <img src="http://blackdwarf.autonomicpilot.co.uk/caps/3d49ea.png" alt="zsa composer.json editing" /></p>

<p>I then proceeded to get composer to install Zend Framework as well as the other dependencies list (zfuser etc) <img src="http://blackdwarf.autonomicpilot.co.uk/caps/7c7105.png" alt="composer install" /></p>

<p>And it all worked lovely, using just php's inbuilt webserver. <img src="http://blackdwarf.autonomicpilot.co.uk/caps/03d9e2.png" alt="phps webserver" /> <img src="http://blackdwarf.autonomicpilot.co.uk/caps/256488.png" alt="zsa initial load" /></p>

<p>I then added the new modules to application configuration <img src="http://blackdwarf.autonomicpilot.co.uk/caps/888d7e.png" alt="application config for new mods" />. You may be thinking there's some trickery going on the get zf-commons/zfc-user loading as ZfcUser, and you'd be right <img src="http://blackdwarf.autonomicpilot.co.uk/caps/2fa6e8.png" alt="zfc trickery" /></p>

<p>And then I set up the sqlite db using the schema that comes with ZfcUer <img src="http://blackdwarf.autonomicpilot.co.uk/caps/351dc9.png" alt="sqlite schema setup" /> and added the file for local database configuration <img src="http://blackdwarf.autonomicpilot.co.uk/caps/49d299.png" alt="db config" /></p>

<p>The next time I ran the webserver I was able to navigate to /user and get to a lovely login page.</p>

<p><img src="http://blackdwarf.autonomicpilot.co.uk/caps/76a23d.png" alt="zfcuser login page" /></p>

<p>It was all just that easy to get going!</p>

<p>Have a look on <a href="https://github.com/gabriel403/ZendSkeletonApplication/tree/ZFCUser">github</a></p>

                    </div>
                    </div>
                </div>
                <div id="right" class="float_left">
                    <div class="box0n">
                        <h2>Tags</h2>
                        <br />
        <a href="/blog/Tags/Service Locator.html">Service Locator</a>:1        <a href="/blog/Tags/Service Manager.html">Service Manager</a>:1        <a href="/blog/Tags/Dependency Injection.html">Dependency Injection</a>:1        <a href="/blog/Tags/invokables.html">invokables</a>:2        <a href="/blog/Tags/factories.html">factories</a>:2        <a href="/blog/Tags/php.html">php</a>:3        <a href="/blog/Tags/zf2.html">zf2</a>:6        <a href="/blog/Tags/zendframework2.html">zendframework2</a>:4        <a href="/blog/Tags/Zend\Form.html">Zend\Form</a>:2        <a href="/blog/Tags/Zend\Form\Annotation.html">Zend\Form\Annotation</a>:1        <a href="/blog/Tags/ComposedObject.html">ComposedObject</a>:1        <a href="/blog/Tags/composer.html">composer</a>:2        <a href="/blog/Tags/translation.html">translation</a>:1        <a href="/blog/Tags/html.html">html</a>:2        <a href="/blog/Tags/responsive.html">responsive</a>:1        <a href="/blog/Tags/noframework.html">noframework</a>:1        <a href="/blog/Tags/blog.html">blog</a>:2        <a href="/blog/Tags/zfc.html">zfc</a>:1
                    </div>
                    <div class="box0n">
                        <h2>Categories</h2>
                        <br />
        <a href="/blog/Categories/IoC.html">IoC</a><br />        <a href="/blog/Categories/ZF2.html">ZF2</a><br />        <a href="/blog/Categories/blog.html">blog</a><br />        <a href="/blog/Categories/readme.html">readme</a><br />        <a href="/blog/Categories/Uncategorised.html">Uncategorised</a><br />
                    </div>
                </div>
                <br class="clear_both" />
            </div>
        </div>
        <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?autoload=true&skin=sons-of-obsidian" defer="defer"></script>
        <script type="text/javascript" src="/js/ga.js"></script>
    </body>
</html>